(this["webpackJsonpcards-game"]=this["webpackJsonpcards-game"]||[]).push([[0],{10:function(e,t,a){e.exports={container:"Container_container__3RIox",narrow:"Container_narrow__382JJ",regular:"Container_regular__2e5B9",tall:"Container_tall__2bclv",flex:"Container_flex__25deY",centered:"Container_centered__2yI3R",column:"Container_column__1dKFA"}},11:function(e,t,a){e.exports={hand:"Player_hand__1P5YQ",npcHand:"Player_npcHand__36PSG",userHand:"Player_userHand__35MuX",card:"Player_card__12WYS",userCard:"Player_userCard__3KB1Q",npcCard:"Player_npcCard__23vEw"}},17:function(e,t,a){e.exports={board:"Board_board__1-Hp0",fadeIn:"Board_fadeIn__nU0hZ",threePlayer:"Board_threePlayer__34vKQ",twoPlayer:"Board_twoPlayer__3WazD",fourPlayer:"Board_fourPlayer__3gg5n"}},38:function(e,t,a){e.exports={heading:"StartGameLinks_heading__HN4Lm"}},39:function(e,t,a){e.exports={link:"Link_link__3euZY"}},50:function(e,t,a){},51:function(e,t,a){},77:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(18),s=a.n(c),i=(a(50),a(51),a(21)),o=a(2),l=a(38),d=a.n(l),u=a(3),j=a(13),h=a(39),f=a.n(h),b=a(1);function p(e){var t=e.className,a=void 0===t?"":t,n=Object(j.a)(e,["className"]);return a="".concat(f.a.link," ").concat(a),Object(b.jsx)(i.b,Object(u.a)({className:a},n))}function O(){var e=Object(o.f)(),t=function(t,a){a===e.location.pathname&&(t.preventDefault(),e.push("".concat(a,"?reload=true")))};return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("h1",{className:d.a.heading,children:"Select number of players"}),Object(b.jsx)(p,{onClick:function(e){return t(e,"/game/2")},to:"/game/2",children:"2"}),Object(b.jsx)(p,{onClick:function(e){return t(e,"/game/3")},to:"/game/3",children:"3"}),Object(b.jsx)(p,{onClick:function(e){return t(e,"/game/4")},to:"/game/4",children:"4"})]})}var m=a(8),x=a(10),y=a.n(x),_=a(14),v=a.n(_);function g(e){var t,a=e.as,n=void 0===a?"div":a,r=e.className,c=void 0===r?"":r,s=e.flex,i=e.width,o=void 0===i?"regular":i,l=e.direction,d=void 0===l?"row":l,h=e.tall,f=e.centered,p=Object(j.a)(e,["as","className","flex","width","direction","tall","centered"]);return c=v()(y.a.container,y.a[o],y.a[d],(t={},Object(m.a)(t,y.a.flex,s),Object(m.a)(t,y.a.centered,f),Object(m.a)(t,y.a.tall,h),t),c),Object(b.jsx)(n,Object(u.a)({},Object(u.a)(Object(u.a)({},p),{},{className:c})))}function w(){return Object(b.jsx)(g,{width:"narrow",tall:!0,flex:!0,centered:!0,direction:"column",children:Object(b.jsx)(O,{})})}var C={0:"You",1:"Mr 2",2:"Mister 3",3:"Mister 4"},P=function(e){switch(e){case"KING":return 14;case"QUEEN":return 13;case"JACK":return 12;case"ACE":return 1;default:return parseInt(e)}};var N=a(9);function k(e){var t=e.players.reduce((function(e,t){return e.score>t.score?e:t}));return Object(b.jsxs)(g,{flex:!0,direction:"column",children:[Object(b.jsxs)("h3",{className:"text-white",children:[t.name," Won! Play again?"]}),Object(b.jsx)(O,{})]})}function S(e){var t=e.className,a=e.image,n=e.suit,r=e.value,c=e.onCardPick,s=e.disable;return Object(b.jsx)("button",{className:t,onClick:c,disabled:s,children:Object(b.jsx)(R,{src:a,alt:"".concat(n," ").concat(r)})})}function R(e){var t=e.alt,a=void 0===t?"":t,n=Object(j.a)(e,["alt"]);return Object(b.jsx)("img",Object(u.a)({width:"100px",alt:a},n))}function E(e){var t=e.discard;return Object(b.jsxs)("section",{children:[Object(b.jsx)("h4",{className:"text-info text-center pb-2",children:"Discard pile:"}),Object(b.jsx)("ul",{className:"flex",children:t.map((function(e){var t=e.player,a=e.card;return Object(b.jsxs)("li",{children:[Object(b.jsx)(R,{src:a.image}),Object(b.jsx)("h5",{className:"text-white",children:t.name})]},a.code)}))})]})}var I=a(17),H=a.n(I);function B(e){var t=e.playerCount,a=e.children,n=function(e){return Object(b.jsx)("div",{className:"".concat(H.a.board," ").concat(e),children:a})};switch(t){case 2:return n(H.a.twoPlayer);case 3:return n(H.a.threePlayer);case 4:return n(H.a.fourPlayer);default:throw new Error("Invalid number of players")}}var T=a(44),L=a(11),M=a.n(L),V=a(27),W=a.n(V),G=a(41),U=a(16),D=a(20),J=a(45),K=a(43),Y=a(42),Q=a.n(Y),z=new(function(e){Object(J.a)(a,e);var t=Object(K.a)(a);function a(){var e;return Object(D.a)(this,a),(e=t.call(this,"https://deckofcardsapi.com/api/deck")).fetchNewDeck=function(t){return e.instance.get("".concat("/new/draw/?count=").concat(10*t))},e}return a}((function e(t){var a=this;Object(D.a)(this,e),this.instance=void 0,this._initializeResponseInterceptor=function(){a.instance.interceptors.response.use(a._handleResponse,a._handleError)},this._handleResponse=function(e){return e.data},this._handleError=function(e){return Promise.reject(e)},this.instance=Q.a.create({baseURL:t}),this._initializeResponseInterceptor()}))),A={playerCount:0,players:[],discard:[],status:"idle",isGameOver:!1},F=Object(U.b)("game/start",function(){var e=Object(G.a)(W.a.mark((function e(t,a){var n;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.getState,e.next=3,z.fetchNewDeck(t);case 3:return n=e.sent,e.abrupt("return",{cards:n.cards,count:t});case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),Z=Object(U.c)({name:"game",initialState:A,reducers:{setPlayedHand:function(e,t){var a=t.payload;if(!(e.discard.length>=e.playerCount)){var n=a.player,r=a.card;e.discard.push({player:n,card:r});var c=n.id;e.players[c].hand=e.players[c].hand.filter((function(e){return e.code!==r.code})),e.players[c].turnToPlay=!1,e.players[c+1]?e.players[c+1].turnToPlay=!0:e.players[0].turnToPlay=!0}},setRoundWinner:function(e,t){var a=t.payload,n=a.id,r=a.score;e.players[n].score+=r,e.discard=[],e.isGameOver=0===e.players[0].hand.length}},extraReducers:function(e){e.addCase(F.pending,(function(){return Object(u.a)(Object(u.a)({},A),{},{status:"loading"})})),e.addCase(F.fulfilled,(function(e,t){var a=t.payload;e.playerCount=a.count,e.players=function(e,t){for(var a=[],n=0;n<e.length;n++){var r=n%t,c=e[n];a[r]?a[r].hand.push(c):a[r]={id:r,name:C[r],hand:[c],turnToPlay:!1,score:0}}return a}(a.cards,e.playerCount),e.status="success"}))}}),X=function(e){return e.game},$=Z.actions,q=$.setPlayedHand,ee=$.setRoundWinner,te=Z.reducer;function ae(e){var t,a,r=Object(N.b)(),c=Object(n.useState)(),s=Object(T.a)(c,2),i=s[0],o=s[1],l=e.name,d=e.hand,j=e.score,h=e.turnToPlay,f=e.isUser;Object(n.useEffect)((function(){!f&&h&&o(Math.floor(Math.random()*d.length)),void 0!==i&&(r(q({player:e,card:d[i]})),o(void 0))}),[r,d,f,i,e,h]);var p=v()({"text-gold":f,"text-white":!f}),O=v()(M.a.hand,(t={},Object(m.a)(t,M.a.userHand,f),Object(m.a)(t,M.a.npcHand,!f),t)),x=v()(M.a.card,(a={},Object(m.a)(a,M.a.userCard,f),Object(m.a)(a,M.a.npcCard,!f),a));return Object(b.jsxs)("article",{className:"text-center",children:[Object(b.jsx)("h2",{className:p,children:l}),Object(b.jsxs)("h3",{className:"text-white py-2",children:["Score: ",j]}),Object(b.jsx)("section",{className:O,children:d.map((function(e,t){return Object(b.jsx)(S,Object(u.a)({className:x,cardIndex:t,disable:!f,onCardPick:function(){return o(t)}},e),e.code)}))})]})}function ne(){return Object(b.jsx)(g,{tall:!0,flex:!0,centered:!0,children:Object(b.jsx)("p",{className:"text-white",children:"Loading..."})})}function re(e){var t=e.playerCount,a=e.isReloaded,r=Object(N.b)(),c=Object(N.c)(X),s=c.players,i=c.status,o=c.discard,l=c.isGameOver;Object(n.useEffect)((function(){r(F(t))}),[r,t,a]),Object(n.useEffect)((function(){if(o.length===t){var e=function(e){return e.map((function(e){return Object(u.a)(Object(u.a)({},e),{},{cardValue:P(e.card.value)})})).reduce((function(e,t){return e.cardValue<=t.cardValue&&(e.id=t.player.id,e.cardValue=t.cardValue),e.scoreSum+=t.cardValue,e}),{id:0,scoreSum:0,cardValue:0})}(o),a=setTimeout((function(){r(ee({id:e.id,score:e.scoreSum}))}),1e3);return function(){return clearTimeout(a)}}}),[o,t,r]);var d,j="error"===i;if("loading"===i||"idle"===i)d=Object(b.jsx)(ne,{});else if(j)d=Object(b.jsx)("p",{children:"Something went wrong..."});else{var h=s.map((function(e){var t=0===e.id;return Object(b.jsx)(ae,Object(u.a)({isUser:t},e),e.id)}));d=Object(b.jsxs)(B,{playerCount:s.length,children:[h,l?Object(b.jsx)(k,{players:s}):Object(b.jsx)(E,{discard:o})]})}return Object(b.jsx)(b.Fragment,{children:d})}function ce(e){var t,a=e.match,r=e.location,c=e.history,s=parseInt(a.params.playerCount),i=!!new URLSearchParams(r.search).get("reload"),o=Object(b.jsxs)(g,{width:"narrow",tall:!0,flex:!0,centered:!0,direction:"column",children:[Object(b.jsx)(O,{}),Object(b.jsxs)("p",{className:"text-error",children:["Looks like you tried to play with",s>4?" more ":" less ","players than allowed."]})]});return Object(n.useEffect)((function(){return i&&c.replace({search:""}),function(){}}),[i,c]),(t=s)>=2&&t<=4?Object(b.jsx)(re,{playerCount:s,isReloaded:i}):o}function se(){return Object(b.jsxs)(g,{flex:!0,tall:!0,centered:!0,direction:"column",children:[Object(b.jsx)("p",{className:"text-white",children:"Page not found... Try clicking on one of these instead"}),Object(b.jsx)(O,{})]})}var ie=function(){return Object(b.jsx)("main",{className:"app",children:Object(b.jsx)(i.a,{children:Object(b.jsxs)(o.c,{children:[Object(b.jsx)(o.a,{path:"/game/:playerCount",component:ce}),Object(b.jsx)(o.a,{path:"/",component:w,exact:!0}),Object(b.jsx)(o.a,{path:"*",component:se})]})})})},oe=Object(U.a)({reducer:{game:te}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(Object(b.jsx)(r.a.StrictMode,{children:Object(b.jsx)(N.a,{store:oe,children:Object(b.jsx)(ie,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[77,1,2]]]);
//# sourceMappingURL=main.e92e57cf.chunk.js.map